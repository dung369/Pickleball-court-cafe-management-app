<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pickleball Drink Manager</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- LOGIN SCREEN -->
  <div class="login-container" id="loginContainer">
    <div class="login-box">
      <h1>üèì Pickleball Drink</h1>
      <h2>ƒêƒÉng nh·∫≠p h·ªá th·ªëng</h2>
      <form id="loginForm" onsubmit="handleLogin(event)">
        <div class="form-group">
          <label>T√™n ƒëƒÉng nh·∫≠p</label>
          <input type="text" id="loginUsername" required placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p">
        </div>
        <div class="form-group">
          <label>M·∫≠t kh·∫©u</label>
          <input type="password" id="loginPassword" required placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
        </div>
        <button type="submit" class="btn btn-primary btn-block">ƒêƒÉng nh·∫≠p</button>
      </form>
      <div id="loginError" class="error-message" style="display:none; color:red; margin-top:10px;"></div>
    </div>
  </div>

  <div class="app-container" id="appContainer" style="display: none;">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="logo">
        <h2>üèì Pickleball Drink</h2>
        <p id="currentUserInfo" style="font-size:12px; color:#ccc; margin-top:5px;"></p>
      </div>
      <nav class="nav-menu">
        <button class="nav-btn active" data-view="tables">
          <span class="icon">ü™ë</span> Qu·∫£n l√Ω b√†n
        </button>
        <button class="nav-btn" data-view="menu">
          <span class="icon">üìã</span> Menu
        </button>
        <button class="nav-btn" data-view="bills">
          <span class="icon">üßæ</span> L·ªãch s·ª≠
        </button>
        <button class="nav-btn" data-view="reports">
          <span class="icon">üìä</span> B√°o c√°o
        </button>
      </nav>
      <div style="padding: 20px; margin-top: auto;">
        <button class="btn btn-danger btn-block" onclick="handleLogout()">üö™ ƒêƒÉng xu·∫•t</button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- QU·∫¢N L√ù B√ÄN -->
      <section class="view-section active" id="tables-view">
        <div class="section-header">
          <h1>Qu·∫£n l√Ω b√†n</h1>
          <div class="legend">
            <span class="legend-item"><span class="dot empty"></span> Tr·ªëng</span>
            <span class="legend-item"><span class="dot serving"></span> ƒêang ph·ª•c v·ª•</span>
            <span class="legend-item"><span class="dot unpaid"></span> Ch∆∞a thanh to√°n</span>
            <button class="btn btn-success" onclick="addNewTable()" style="margin-left: auto;">‚ûï Th√™m b√†n m·ªõi</button>
            <button class="btn btn-danger" onclick="deleteTableFromGrid()" style="margin-left: 10px;">üóëÔ∏è X√≥a b√†n</button>
          </div>
        </div>

        <div class="tables-grid" id="tablesGrid"></div>
      </section>

      <!-- MENU -->
      <section class="view-section" id="menu-view">
        <div class="section-header">
          <h1>Qu·∫£n l√Ω Menu</h1>
          <button class="btn btn-primary" id="addMenuItemBtn" onclick="document.getElementById('menuItemModalTitle').textContent='Th√™m m√≥n m·ªõi';document.getElementById('menuItemForm').reset();document.getElementById('menuItemId').value='';document.getElementById('menuItemModal').classList.add('active');">+ Th√™m m√≥n m·ªõi</button>
        </div>

        <div class="menu-controls">
          <input type="text" id="menuSearch" class="search-input" placeholder="üîç T√¨m ki·∫øm m√≥n...">
          <select id="categoryFilter" class="select-input">
            <option value="">T·∫•t c·∫£ danh m·ª•c</option>
          </select>
          <select id="sortBy" class="select-input">
            <option value="name">T√™n m√≥n</option>
            <option value="price-asc">Gi√° tƒÉng d·∫ßn</option>
            <option value="price-desc">Gi√° gi·∫£m d·∫ßn</option>
            <option value="popular">M√≥n b√°n ch·∫°y</option>
          </select>
        </div>

        <div class="menu-grid" id="menuGrid"></div>
      </section>

      <!-- L·ªäCH S·ª¨ H√ìA ƒê∆†N -->
      <section class="view-section" id="bills-view">
        <div class="section-header">
          <h1>L·ªãch s·ª≠ h√≥a ƒë∆°n</h1>
          <div class="date-filter">
            <input type="date" id="startDate" class="date-input">
            <span>ƒë·∫øn</span>
            <input type="date" id="endDate" class="date-input">
            <button class="btn btn-secondary" id="filterBillsBtn">L·ªçc</button>
          </div>
        </div>

        <div class="bills-container">
          <table class="bills-table">
            <thead>
              <tr>
                <th>M√£ Hƒê</th>
                <th>Ng√†y gi·ªù</th>
                <th>B√†n</th>
                <th>T·ªïng ti·ªÅn</th>
                <th>Gi·∫£m gi√°</th>
                <th>Thanh to√°n</th>
                <th>Thu ng√¢n</th>
                <th>H√†nh ƒë·ªông</th>
              </tr>
            </thead>
            <tbody id="billsTableBody"></tbody>
          </table>
        </div>
      </section>

      <!-- B√ÅO C√ÅO -->
      <section class="view-section" id="reports-view">
        <div class="section-header">
          <h1>B√°o c√°o doanh thu</h1>
          <div class="report-controls">
            <input type="date" id="reportStartDate" class="date-input">
            <input type="date" id="reportEndDate" class="date-input">
            <button class="btn btn-primary" id="generateReportBtn">T·∫°o b√°o c√°o</button>
          </div>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <h3>T·ªïng doanh thu</h3>
            <p class="stat-value" id="totalRevenue">0ƒë</p>
          </div>
          <div class="stat-card">
            <h3>S·ªë h√≥a ƒë∆°n</h3>
            <p class="stat-value" id="totalBills">0</p>
          </div>
          <div class="stat-card">
            <h3>Gi√° tr·ªã trung b√¨nh</h3>
            <p class="stat-value" id="avgBill">0ƒë</p>
          </div>
          <div class="stat-card">
            <h3>T·ªïng gi·∫£m gi√°</h3>
            <p class="stat-value" id="totalDiscount">0ƒë</p>
          </div>
        </div>

        <div class="report-section">
          <h2>Ph√¢n t√≠ch theo ph∆∞∆°ng th·ª©c thanh to√°n</h2>
          <div id="paymentMethodChart"></div>
        </div>

        <div class="report-section">
          <h2>Top 10 m√≥n b√°n ch·∫°y</h2>
          <table class="top-items-table">
            <thead>
              <tr>
                <th>T√™n m√≥n</th>
                <th>S·ªë l∆∞·ª£ng</th>
                <th>Doanh thu</th>
              </tr>
            </thead>
            <tbody id="topItemsTableBody"></tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal Order Details -->
  <div class="modal" id="orderModal">
    <div class="modal-content large">
      <div class="modal-header">
        <h2>B√†n <span id="modalTableNumber"></span></h2>
        <button class="close-btn" id="closeOrderModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="order-container">
          <div class="menu-selection">
            <input type="text" id="orderMenuSearch" class="search-input" placeholder="üîç T√¨m m√≥n...">
            <div class="category-tabs" id="orderCategoryTabs"></div>
            <div class="menu-items-grid" id="orderMenuItems"></div>
          </div>
          <div class="order-summary">
            <h3>M√≥n ƒë√£ order</h3>
            <div class="order-items" id="orderItems"></div>
            <div class="order-total">
              <h3>T·ªïng c·ªông: <span id="orderTotalAmount">0ƒë</span></h3>
            </div>
            <div class="order-actions">
              <button class="btn btn-secondary" id="transferTableBtn">Chuy·ªÉn b√†n</button>
              <button class="btn btn-secondary" id="mergeTableBtn">G·ªôp b√†n</button>
              <button class="btn btn-warning" id="splitTableBtn" style="display: none;">T√°ch b√†n</button>
              <button class="btn btn-success" id="checkoutBtn">Thanh to√°n</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Checkout -->
  <div class="modal" id="checkoutModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Thanh to√°n - B√†n <span id="checkoutTableNumber"></span></h2>
        <button class="close-btn" id="closeCheckoutModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="checkout-summary" id="checkoutSummary"></div>
        <div class="form-group">
          <label>T·ªïng ti·ªÅn:</label>
          <input type="text" id="checkoutTotal" class="form-input" readonly>
        </div>
        <div class="form-group">
          <label>Gi·∫£m gi√°:</label>
          <input type="number" id="checkoutDiscount" class="form-input" value="0" min="0">
        </div>
        <div class="form-group">
          <label>Th√†nh ti·ªÅn:</label>
          <input type="text" id="checkoutFinal" class="form-input" readonly>
        </div>
        <div class="form-group">
          <label>Ph∆∞∆°ng th·ª©c thanh to√°n:</label>
          <select id="paymentMethod" class="select-input">
            <option value="cash">Ti·ªÅn m·∫∑t</option>
            <option value="transfer">Chuy·ªÉn kho·∫£n</option>
            <option value="qr">QR Banking</option>
          </select>
        </div>
        <div class="form-group">
          <label>Thu ng√¢n:</label>
          <input type="text" id="cashierName" class="form-input" placeholder="T√™n thu ng√¢n">
        </div>
        <button class="btn btn-success btn-block" id="confirmCheckoutBtn">X√°c nh·∫≠n thanh to√°n</button>
      </div>
    </div>
  </div>

  <!-- Modal Add/Edit Menu Item -->
  <div class="modal" id="menuItemModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="menuItemModalTitle">Th√™m m√≥n m·ªõi</h2>
        <button class="close-btn" id="closeMenuItemModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="menuItemForm">
          <input type="hidden" id="menuItemId">
          <div class="form-group">
            <label>T√™n m√≥n:</label>
            <input type="text" id="menuItemName" class="form-input" required>
          </div>
          <div class="form-group">
            <label>Gi√° (VNƒê):</label>
            <input type="number" id="menuItemPrice" class="form-input" required min="0">
          </div>
          <div class="form-group">
            <label>Danh m·ª•c:</label>
            <select id="menuItemCategory" class="select-input" required></select>
          </div>
          <div class="form-group">
            <label>M√¥ t·∫£:</label>
            <textarea id="menuItemDesc" class="form-input" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-primary btn-block">L∆∞u</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal Bill Detail -->
  <div class="modal" id="billDetailModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Chi ti·∫øt h√≥a ƒë∆°n</h2>
        <button class="close-btn" id="closeBillDetailModal">&times;</button>
      </div>
      <div class="modal-body" id="billDetailContent"></div>
    </div>
  </div>

  <!-- Modal Select Table -->
  <div class="modal" id="selectTableModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="selectTableTitle">Ch·ªçn b√†n</h2>
        <button class="close-btn" id="closeSelectTableModal">&times;</button>
      </div>
      <div class="modal-body">
        <p id="selectTableMessage" style="margin-bottom: 20px;"></p>
        <div class="tables-grid" id="selectTableGrid"></div>
      </div>
    </div>
  </div>

  <!-- Modal Confirm -->
  <div class="modal" id="confirmModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="confirmTitle">X√°c nh·∫≠n</h2>
        <button class="close-btn" id="closeConfirmModal">&times;</button>
      </div>
      <div class="modal-body">
        <p id="confirmMessage"></p>
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="btn btn-secondary btn-block" id="confirmCancelBtn">H·ªßy</button>
          <button class="btn btn-danger btn-block" id="confirmOkBtn">X√°c nh·∫≠n</button>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
